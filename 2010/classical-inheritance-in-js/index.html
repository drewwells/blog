
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Classical Inheritance in JS - Tales from a JavaScript Developer</title>
  <meta name="author" content="Drew Wells">

  
  <meta name="description" content="Edit: Alex pointed out this example uses classical not prototypal inheritance as stated on John Resig&#8217;s blog.Recently I&#8217;ve been introdu...">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://drewwells.net/blog/2010/classical-inheritance-in-js/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Tales from a JavaScript Developer" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Tales from a JavaScript Developer</a></h1>
  
    <h2>Practicing JavaScript ninja</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:drewwells.net/blog" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Classical Inheritance in JS</h1>
    
    
      <p class="meta">
        





  



<time datetime="2010-03-11T17:16:24-05:00" pubdate  data-updated="true" >Mar 11<span>th</span>, 2010</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>Edit: Alex pointed out this example uses classical not prototypal inheritance as stated on John Resig&#8217;s blog.</p>

<p>Recently I&#8217;ve been introduced to Prototypal Inheritance thanks to Alex Sexton <a href="http://alexsexton.com/?p=51">Using Inheritance to Organize Large jQuery Applications</a>.  I will attempt to give a short introduction to this concept.  My understanding of the how is very limited.  Fortunately, as I have found out, that doesn&#8217;t prevent me from using it!</p>

<p><strong>Background, skip this if you know about Prototypal Inheritance</strong>
JavaScript supports inheritance via the idea of a prototype.  Everything in JavaScript is an object and every object has a prototype.  You can inherit attributes from another object by pointing to it&#8217;s prototype.  You can read about that in the above article or from many other great resources:</p>

<ul>
    <li><a href="http://javascript.crockford.com/prototypal.html">Prototypal Inheritance in JavaScript</a></li>
    <li><a href="http://www.bennadel.com/blog/1566-Using-Super-Constructors-Is-Critical-In-Prototypal-Inheritance-In-Javascript.htm">Using Super Constructors Is Critical In Prototypal Inheritance In Javascript</a></li>
</ul>


<p>I wanted to go beyond a simple example and really implement this in a working application and explore the pros and cons of this methodology.  Fortunately, Ben Nadel posted a fun little application to take apart.  Read about it <a href="http://www.bennadel.com/blog/1872-Using-Base64-Canvas-Data-In-jQuery-To-Create-ColdFusion-Images.htm">here</a>.  I would like to point out that I did not write this code, I am only borrowing it to show how to take some reasonably sophisticated JavaScript and refactor it for utilizing Inheritance.</p>

<p>I had a couple goals here.  One, add Android support.  Two, explore Inheritance.  Now, I need to settle on a inheritance pattern.  I chose to utilize John Resig&#8217;s <a href="http://ejohn.org/blog/simple-javascript-inheritance/">Simple JavaScript Inheritance</a>.  Why?  It is simple to understand and Alex&#8217;s method is a little over my pay grade.</p>

<p>So I create a super class, a class that other objects can use Classical-ly inherit from.  This became the Touch Class:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">Touch</span> <span class="o">=</span> <span class="nx">Class</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">localPosition</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">lastPenPoint</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">position</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">){</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">touch</span> <span class="o">=</span> <span class="p">(</span>
</span><span class='line'>          <span class="nx">isIPhone</span> <span class="o">?</span>
</span><span class='line'>              <span class="nb">window</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">targetTouches</span><span class="p">[</span> <span class="mi">0</span> <span class="p">]</span> <span class="o">:</span>
</span><span class='line'>              <span class="nx">event</span>
</span><span class='line'>      <span class="p">)</span>
</span><span class='line'>      <span class="nx">position</span> <span class="o">=</span>
</span><span class='line'>          <span class="nx">canvas</span><span class="p">.</span><span class="nx">offset</span><span class="p">(),</span>
</span><span class='line'>      <span class="nx">localPosition</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">x</span><span class="o">:</span> <span class="p">(</span> <span class="nx">touch</span><span class="p">.</span><span class="nx">pageX</span> <span class="o">-</span> <span class="nx">position</span><span class="p">.</span><span class="nx">left</span> <span class="p">),</span>
</span><span class='line'>          <span class="nx">y</span><span class="o">:</span> <span class="p">(</span> <span class="nx">touch</span><span class="p">.</span><span class="nx">pageY</span> <span class="o">-</span> <span class="nx">position</span><span class="p">.</span><span class="nx">top</span> <span class="p">)</span>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>      <span class="nx">lastPenPoint</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">x</span><span class="o">:</span> <span class="nx">localPosition</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">y</span><span class="o">:</span> <span class="nx">localPosition</span><span class="p">.</span><span class="nx">y</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Previously, the position and penpoint were being calculated by a seperate function.  I have added these to the init of the prototype.  So everytime a new Touch class is constructed (keyword new), these fields are already populated.  Now, we can rewrite onTouchStart and onTouchMove to extend this class and remove a lot of redundant code.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="c1">// I handle the touch start event. With this event,</span>
</span><span class='line'><span class="c1">// we will be starting a new line.</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">onTouchStart</span> <span class="o">=</span> <span class="nx">Touch</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">){</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>  <span class="c1">//inherit some common touch properties</span>
</span><span class='line'>      <span class="nx">pen</span><span class="p">.</span><span class="nx">beginPath</span><span class="p">();</span>
</span><span class='line'>      <span class="nx">pen</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span> <span class="nx">lastPenPoint</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">lastPenPoint</span><span class="p">.</span><span class="nx">y</span> <span class="p">);</span>
</span><span class='line'>      <span class="c1">// Now that we have initiated a line, we need to</span>
</span><span class='line'>      <span class="c1">// bind the touch/mouse event listeners.</span>
</span><span class='line'>      <span class="nx">canvas</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span>
</span><span class='line'>          <span class="p">(</span><span class="nx">isTouch</span> <span class="o">?</span> <span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">touchmove</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span> <span class="o">:</span> <span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">mousemove</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;),</span>
</span><span class='line'>          <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">){</span>
</span><span class='line'>              <span class="k">new</span> <span class="nx">onTouchMove</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">);</span>
</span><span class='line'>      <span class="c1">// Bind the touch/mouse end events so we know</span>
</span><span class='line'>      <span class="c1">// when to end the line.</span>
</span><span class='line'>      <span class="nx">canvas</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span>
</span><span class='line'>          <span class="p">(</span><span class="nx">isTouch</span> <span class="o">?</span> <span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">touchend</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span> <span class="o">:</span> <span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">mouseup</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;),</span>
</span><span class='line'>          <span class="nx">onTouchEnd</span>
</span><span class='line'>      <span class="p">);</span>
</span><span class='line'>                <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>  <span class="c1">//prevent page from moving while drawing</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'><span class="c1">// I handle the touch move event. With this event, we</span>
</span><span class='line'><span class="c1">// will be drawing a line from the previous point to</span>
</span><span class='line'><span class="c1">// the current point.</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">onTouchMove</span> <span class="o">=</span> <span class="nx">Touch</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">event</span> <span class="p">){</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">(</span> <span class="nx">event</span> <span class="p">);</span>
</span><span class='line'>      <span class="nx">pen</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span> <span class="nx">lastPenPoint</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">lastPenPoint</span><span class="p">.</span><span class="nx">y</span> <span class="p">);</span>
</span><span class='line'>      <span class="nx">pen</span><span class="p">.</span><span class="nx">stroke</span><span class="p">();</span>
</span><span class='line'>      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>  <span class="c1">//prevent page from moving while drawing</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>The important part of these functions is that they call this._super( event ).  When you create new onTouchStart/onTouchMove, they will run their own constructors but not the super classes (inheritance at work don&#8217;t want to run super class constructors unless they are needed).  You will need to call super to run the super class&#8217;s constructor which is handling most of the heavy work of calculating mouse positions and whatnot.</p>

<p>Now, we have converted our function callbacks into classes.  We need to create new instances of these classes to actually use them.  References to the original functions will now be creating instances.  You do this simply with:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="k">new</span> <span class="nx">onTouchMove</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then you are done, your constructor (init) will run and lines are drawn on the screen.</p>

<p>Comment below any tips for improving on this or questions about how it works.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">admin</span></span>

      





  



<time datetime="2010-03-11T17:16:24-05:00" pubdate  data-updated="true" >Mar 11<span>th</span>, 2010</time>
      


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://drewwells.net/blog/2010/classical-inheritance-in-js/" data-via="coldfuser" data-counturl="http://drewwells.net/blog/2010/classical-inheritance-in-js/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
</div>

    
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2011/my-adventures-into-webgl/">My adventures into WebGL</a>
      </li>
    
      <li class="post">
        <a href="/2011/jodoc-js/">jodoc-js</a>
      </li>
    
      <li class="post">
        <a href="/2011/testing-for-optional-false-params-in-javascript/">Testing for optional false params in JavaScript</a>
      </li>
    
      <li class="post">
        <a href="/2011/github/">Github</a>
      </li>
    
      <li class="post">
        <a href="/2011/hp-pavilion-dv6-quad-edition/">HP Pavilion dv6 Quad Edition</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Github Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/drewwells">@drewwells</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'drewwells',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("coldfuser", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/coldfuser" class="twitter-follow-button" data-width="208px" data-show-count="false">Follow @coldfuser</a>
  
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2011 - Drew Wells -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
    var disqus_shortname = 'drewwells';

      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://drewwells.net/blog/2010/classical-inheritance-in-js/';
        var disqus_url = 'http://drewwells.net/blog/2010/classical-inheritance-in-js/';
        var disqus_script = 'embed.js';
      

    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>



  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-2783646-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>





</body>
</html>
